2025-01-05 17:33:10,596 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:315)
2025-01-05 17:33:11,783 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:317)
2025-01-05 17:33:11,860 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:311)
2025-01-05 17:33:52,395 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:303)
2025-01-05 17:33:52,396 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2070)
2025-01-05 17:33:52,403 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2070)
2025-01-05 17:33:52,408 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__seed_model__2185867172', 'sqlmesh_example__full_model__2278521865', 'sqlmesh_example__incremental_model__772980299', 'sqlmesh_example__full_model__2278521865__temp') (base.py:2070)
2025-01-05 17:33:52,492 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Promoting environment 'prod' (engine_adapter.py:276)
2025-01-05 17:33:52,560 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Altering table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__2278521865' (evaluator.py:1327)
2025-01-05 17:33:52,561 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__2278521865" (base.py:2070)
2025-01-05 17:33:52,563 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__2278521865__temp" (base.py:2070)
2025-01-05 17:33:52,578 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Pausing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 3336183284> (engine_adapter.py:468)
2025-01-05 17:33:52,578 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 404454038> (engine_adapter.py:445)
2025-01-05 17:33:52,579 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Unpausing snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 666059090> (engine_adapter.py:445)
2025-01-05 17:33:52,598 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example' (evaluator.py:976)
2025-01-05 17:33:52,598 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example" (base.py:2070)
2025-01-05 17:33:52,600 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.incremental_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__772980299' (evaluator.py:1247)
2025-01-05 17:33:52,602 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."incremental_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__772980299" (base.py:2070)
2025-01-05 17:33:52,609 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "db"."sqlmesh_example"."incremental_model"."new_column" IS 'Added column' (base.py:2070)
2025-01-05 17:33:52,618 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example.full_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__2278521865' (evaluator.py:1247)
2025-01-05 17:33:52,620 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example"."full_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__2278521865" (base.py:2070)
2025-01-05 17:33:52,627 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Finalizing environment 'prod' (engine_adapter.py:397)
2025-01-05 17:33:52,695 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
